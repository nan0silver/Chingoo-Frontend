import{W as i}from"./index-TarflS5h.js";class c extends i{constructor(){super(...arguments),this.hasInit=!1,this.initForWeb=async t=>{var o;try{await this.loadSDK(),this.testSDK(),this.hasInit||((o=window.Kakao)===null||o===void 0||o.init(t),this.hasInit=!0)}catch(e){return console.error("Error loading Kakao SDK",e),Promise.reject(e)}},this.goLogin=()=>(this.testSDK(),new Promise((t,o)=>{try{window.Kakao.Auth.login({throughTalk:!0,persistAccessToken:!0,success:e=>{console.log(e),this.response=e;const r=new Date;r.setSeconds(r.getSeconds()+e.expires_in);const n=new Date;n.setSeconds(n.getSeconds()+e.refresh_token_expires_in),t({accessToken:e.access_token,expiredAt:r.toISOString(),expiresIn:e.expires_in.toString(10),refreshToken:e.refresh_token,refreshTokenExpiresIn:e.refresh_token_expires_in.toString(10),tokenType:e.token_type,idToken:e.id_token,refreshTokenExpiredAt:e.refresh_token_expires_in.toString(10)})},fail:e=>{console.error("Kakao Login Failed",e),o(new Error("Kakao Login Failed"))}})}catch(e){console.error("Error during Kakao login",e),o(e)}})),this.loadSDK=()=>new Promise((t,o)=>{if(document.getElementById("kakao-script"))return t();const e=document.createElement("script");e.id="kakao-script",e.type="text/javascript",e.onload=t,e.onerror=o,e.src="//developers.kakao.com/sdk/js/kakao.min.js",document.head.appendChild(e)})}async goLogout(){return this.testSDK(),new Promise((t,o)=>{var e;const r=()=>{this.response=void 0,t()};try{(e=window.Kakao)===null||e===void 0||e.Auth.logout(r)}catch(n){console.error("Error logging out",n),o(n)}})}getUserInfo(){return this.testSDK(),this.response?new Promise((t,o)=>{window.Kakao.API.request({url:"/v2/user/me",success:e=>{t({value:e})},fail:e=>{console.error(e),o(e)}})}):Promise.reject("Not logged in.")}sendLinkFeed(t){throw this.unimplemented("Not implemented on web.")}talkInChannel(t){throw this.unimplemented("Not implemented on web.")}testSDK(){if(!window.Kakao)throw new Error("Kakao script not loaded. Call initForWeb for first")}}export{c as KakaoLoginPluginWeb};
